\section{Setup}
\label{sec:setup}

The evaluation was performed on a 64-bit machine running Ubuntu 10.04 LTS. The machine featured a 3.0 Ghz Intel\textregistered Core\texttrademark 2 Duo processor and 4 Gb RAM. The version of LLVM used was 3.0, and Java was running on version 1.6.0\_26.

A Ruby script was written to run the experiments. Each benchmark was compiled into 5 different versions, the original Java code, the translated LLVM bytecode and three further-optimised LLVM modules. 

Each program was first compiled to a Dalvik executable file via the standard procedure. Each was written in Java with the Eclipse IDE, then exported as a .jar file. The \verb|dx| tool, as bundled with the Android SDK, was then used to convert the Java archive to the Dalvik executable format. At this point our compiler was run to translate this file to LLVM intermediate representation. This file was treated as our `base' file. 

In order to examine the effect LLVM's optimisation passes had on code performance, the bytecode was further optimised using the LLVM \verb|opt| tool. In particular, three additional optimised bytecode files were produced. The three optimised versions of the code were passed to LLVM's optimiser with one of the \verb|-O1|, \verb|-O2|, and \verb|-O3| flags. These three flags enable a predefined set of optimsations, which increase in aggressiveness as the level increases: \verb|-O3| run more aggressive optimisations than \verb|-O1| does, for example. The set of optimsations switched on by each \verb|-O| level is not listed, however the documentation claims that they are roughly equivalent to the \verb|-O1|, \verb|-O2|, and \verb|-O3| optimisation flags offered by the GCC compiler.

Each optimised LLVM module was additionally run with a base flag set of \verb|-mem2reg -std-compile-opts -std-link-opts|. The \verb|mem2reg| pass, as described earlier, promotes stack values and memory to registers, and is one of the vital optmization passes the compiler relies upon. The \verb|std-compile-opts| pass activates a standard list of compile-time optimisation passes. The standard list of link-time optimisations is likewise given by the \verb|std-link-opts| flag.

Each of the three optimised LLVM modules, however, resulted in identical code. They are therefore presented together in the results, as there is no difference between them. The different optimisations resulted in identical code because the advanced optimisations offered by the \verb|-O2| and \verb|-O3| flags were not applicable on the relatively straight-forward benchmarks we have used.

Each version was then run 20 times and the runtimes were recorded. The mean value is given in order to smooth out anomalies encountered during execution. The time of day was taken before and after each benchmark was taken, and the difference of these two times was taken as the runtime, in milliseconds. Error bars detailing the minimum and maximum runtimes of each program are given in each Figure to demonstrate the wide fluctuations in runtime that occur during execution.
